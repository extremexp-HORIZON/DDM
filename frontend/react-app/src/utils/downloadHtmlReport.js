// utils/downloadHtmlReport.js

export const downloadHtmlReport = (file,isDarkMode) => {
    if (!file?.profileHtml) return;

    const themeColor = isDarkMode ? "#212529" : "#ffffff";
    const textColor = isDarkMode ? "#e0e0e0" : "#000000";
  

    const formattedHtml = `
       <!DOCTYPE html>
        <html>
            <head>
                <style>
                    body, html {
                        background-color: ${themeColor} !important;
                        color: ${textColor} !important;
                    }

                    /* ðŸ”¥ Fix tables */
                    table, th, td {
                        background-color: ${isDarkMode ? "#2c2f33" : "#ffffff"} !important;
                        color: ${textColor} !important;
                        border-color: ${isDarkMode ? "#444" : "#ccc"} !important;
                        width: 100% !important;
                    }

                    /* ðŸ”¥ Fix dropdowns */
                    .dropdown-menu, .dropdown-content, .select-menu, select {
                        background-color: ${isDarkMode ? "#343a40" : "#ffffff"} !important;
                        color: ${textColor} !important;
                        border-color: ${isDarkMode ? "#6c757d" : "#ccc"} !important;
                    }

                    /* ðŸ”¥ Fix selected tabs */
                    .nav-tabs .nav-link.active {
                        background-color: ${isDarkMode ? "#495057" : "#e9ecef"} !important;
                        color: ${isDarkMode ? "#ffffff" : "#000000"} !important;
                        border-color: ${isDarkMode ? "#6c757d #6c757d #495057" : "#dee2e6 #dee2e6 #ffffff"} !important;
                    }

                    /* ðŸ”¥ Fix buttons */
                    .btn, button {
                        background-color: ${isDarkMode ? "#444" : "#ffffff"} !important;
                        color: ${isDarkMode ? "#e0e0e0" : "#000000"} !important;
                        border-color: ${isDarkMode ? "#666" : "#ccc"} !important;
                        width: auto;
                    }

                    /* ðŸ”¥ Remove unwanted elements */
                    footer:contains('Report generated by YData') { display: none !important; }
                    p:contains('Brought to you by YData') { display: none !important; }
                </style>
            </head>
            <body>
                ${file.profileHtml}
                <footer style="display: flex; align-items: center; justify-content: center; gap: 10px; padding: 10px; font-size: 14px;">
                    <img src="data:image/png;base64,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" alt="ExtremeXP Logo" style="height: 24px; width: 24px;" />
                    <span>ExtremeXP Decentralized Data Management</span>
                </footer>
                <script>
                    document.addEventListener("DOMContentLoaded", function () {
                        // Remove "Brought to you by YData"
                        let ydataText = Array.from(document.body.getElementsByTagName("p")).find(p => p.innerText.includes("Brought to you by YData"));
                        if (ydataText) ydataText.remove();

                        // Remove "Report generated by YData." in the footer
                        let footerText = Array.from(document.getElementsByTagName("footer")).find(footer => footer.innerText.includes("Report generated by YData."));
                        if (footerText) footerText.remove();
                        document.querySelectorAll("p.item-header a").forEach(link => {
                            const span = document.createElement("span"); // Create a plain <span>
                            span.innerHTML = link.innerHTML; // Preserve the text inside <a>
                            link.replaceWith(span); // Replace <a> with <span>
                        });

                        // Also remove standalone links (like the second example)
                        document.querySelectorAll("a").forEach(link => {
                            const span = document.createElement("span");
                            span.innerHTML = link.innerHTML;
                            link.replaceWith(span);
                        });
                        
                    });
                </script>
            </body>
        </html>
    `;

    const blob = new Blob([formattedHtml], { type: "text/html" });
    const url = URL.createObjectURL(blob);

    const a = document.createElement("a");
    a.href = url;
    const rawName = file?.name || file?.file?.name || "report";
    const fileName = rawName.replace(/\.[^/.]+$/, ""); // removes any extension
    a.download = `${fileName}_report.html`;

    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);

    URL.revokeObjectURL(url);
};
